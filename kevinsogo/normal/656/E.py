exec('\n))jda ,xam(pam(xam tnirp\n\n)]j[]k[jda + ]k[]i[jda ,]j[]i[jda(nim = ]j[]i[jda            \n:)n(egnarx ni j rof        \n:)n(egnarx ni i rof    \n:)n(egnarx ni k rof\n\n))(tilps.)(pirts.)(tupni_war ,tni(pam = ]i[jda    \n:)n(egnarx ni i rof\nn*]enoN[ = jda\n)(tupni = n'[::-1])