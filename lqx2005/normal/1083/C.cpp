#define Do_not_hack_it148 	}
#define Do_not_hack_it133 	res.lx=-1;
#define Do_not_hack_it144 	scanf("%d",&n);
#define Do_not_hack_it148 	}
#define Do_not_hack_it42 	if(checkx(u,v,uu)&&checkx(u,v,vv)) return true;
#define Do_not_hack_it31 }
#define Do_not_hack_it92 	build(1,0,n-1);
#define Do_not_hack_it155 void add(int u,int v)
#define Do_not_hack_it148 	}
#define Do_not_hack_it73 			printf("%d\n",now.r+1);
#define Do_not_hack_it31 }
#define Do_not_hack_it94 		t[x].flag=1;
#define Do_not_hack_it148 	}
#define Do_not_hack_it65 int queryst(int l,int r)
#define Do_not_hack_it117 		return;
#define Do_not_hack_it165 void init()
#define Do_not_hack_it122 	int mid=(l+r)/2;
#define Do_not_hack_it178 	else if(check(r.lx,r.rx,l.lx,l.rx)) res.lx=r.lx,res.rx=r.rx,res.flag=1;
#define Do_not_hack_it31 }
#define Do_not_hack_it83 void change(int x,int p,int v)
#define Do_not_hack_it90 	init();
#define Do_not_hack_it170 void dfs(int u,int fa)
#define Do_not_hack_it152 	else change(x*2+1,p,v);
#define Do_not_hack_it148 	}
#define Do_not_hack_it31 }
#define Do_not_hack_it75 {
#define Do_not_hack_it12 		t[x].l=l,t[x].r=r;
#define Do_not_hack_it86 		int v=g[u][i];
#define Do_not_hack_it75 {
#define Do_not_hack_it75 {
#define Do_not_hack_it75 {
#define Do_not_hack_it75 {
#define Do_not_hack_it110 	else query(x*2);
#define Do_not_hack_it9 		scanf("%d",&opt);
#define Do_not_hack_it15 	return queryst(l,r);
#define Do_not_hack_it159 	{
#define Do_not_hack_it116 	return res;
#define Do_not_hack_it112 	t[x]=up(t[x*2],t[x*2+1]);
#define Do_not_hack_it37 	ST();
#define Do_not_hack_it129 	bool flag;
#define Do_not_hack_it45 		{
#define Do_not_hack_it105 		else 
#define Do_not_hack_it142 	for(int i=1;i<=M;i++) p2[i]=p2[i-1]*2;
#define Do_not_hack_it159 	{
#define Do_not_hack_it115 	return;
#define Do_not_hack_it6 		scanf("%d",&v);
#define Do_not_hack_it98 		else now=up(now,t[x*2]);
#define Do_not_hack_it156 	scanf("%d",&q);
#define Do_not_hack_it87 			change(1,p[v],v);
#define Do_not_hack_it108 	else if(check(l.rx,r.rx,l.lx,r.lx)) res.lx=l.rx,res.rx=r.rx,res.flag=1;
#define Do_not_hack_it75 {
#define Do_not_hack_it0 	res.flag=0;
#define Do_not_hack_it68 		st[0][sizest]=u;
#define Do_not_hack_it135 			query(1);
#define Do_not_hack_it31 }
#define Do_not_hack_it69 	int mid=(t[x].l+t[x].r)/2;
#define Do_not_hack_it7 	low[u]=sizest;
#define Do_not_hack_it4 	if(l==r)
#define Do_not_hack_it28 	return false;
#define Do_not_hack_it53 	for(int i=2;i<=N;i++) l2[i]=l2[i/2]+1;
#define Do_not_hack_it75 {
#define Do_not_hack_it47 	res.rx=-1;
#define Do_not_hack_it45 		{
#define Do_not_hack_it112 	t[x]=up(t[x*2],t[x*2+1]);
#define Do_not_hack_it3 	tree res;
#define Do_not_hack_it31 }
#define Do_not_hack_it115 	return;
#define Do_not_hack_it115 	return;
#define Do_not_hack_it19 	if(!r.flag) return res;
#define Do_not_hack_it38 		}
#define Do_not_hack_it41 	g[v].push_back(u);
#define Do_not_hack_it75 {
#define Do_not_hack_it93 }t[N*4],now;
#define Do_not_hack_it75 {
#define Do_not_hack_it128 		for(int j=1;j+p2[i]-1<=sizest;j++) 
#define Do_not_hack_it103 	else if(check(l.rx,r.lx,r.rx,l.lx)) res.lx=l.rx,res.rx=r.lx,res.flag=1;
#define Do_not_hack_it62 	int l=low[u],r=low[v];
#define Do_not_hack_it58 	if(t[x].l==t[x].r) 
#define Do_not_hack_it95 	return 0;
#define Do_not_hack_it31 }
#define Do_not_hack_it75 {
#define Do_not_hack_it70 	int len=(r-l+1);
#define Do_not_hack_it100 	else if(check(l.lx,r.rx,r.lx,l.rx)) res.lx=l.lx,res.rx=r.rx,res.flag=1;
#define Do_not_hack_it174 void query(int x)
#define Do_not_hack_it102 	int fa=lca(u,v);
#define Do_not_hack_it54 const int M=20;
#define Do_not_hack_it131 int p[N+5],dep[N+5],st[M+5][N+5],low[N+5],p2[M+5],l2[N+5];
#define Do_not_hack_it75 {
#define Do_not_hack_it115 	return;
#define Do_not_hack_it17 	for(int i=1;i<=n;i++) scanf("%d",&p[i]),ll[p[i]]=i;
#define Do_not_hack_it38 		}
#define Do_not_hack_it14 	if(l>r) swap(l,r);
#define Do_not_hack_it50 		query(x*2+1);
#define Do_not_hack_it27 	if(t[x*2].flag&&(!now.flag||up(now,t[x*2]).flag))
#define Do_not_hack_it31 }
#define Do_not_hack_it77 		t[x].lx=t[x].rx=v;
#define Do_not_hack_it26 			if(now.flag) now=up(now,t[x]);
#define Do_not_hack_it167 void ST()
#define Do_not_hack_it117 		return;
#define Do_not_hack_it57 int n,q,opt,u,v;
#define Do_not_hack_it89 struct tree
#define Do_not_hack_it51 	bool flag=0;
#define Do_not_hack_it111 	res.l=l.l;
#define Do_not_hack_it32 		t[x].lx=t[x].rx=ll[l];
#define Do_not_hack_it104 	sizest++;
#define Do_not_hack_it30 			swap(p[u],p[v]);
#define Do_not_hack_it117 		return;
#define Do_not_hack_it163 			now.flag=0;
#define Do_not_hack_it22 	int l,r,lx,rx;
#define Do_not_hack_it66 		if(opt==1)
#define Do_not_hack_it151 	for(int i=1;i<=q;i++)
#define Do_not_hack_it159 	{
#define Do_not_hack_it115 	return;
#define Do_not_hack_it84 		if(!now.flag||up(now,t[x]).flag)
#define Do_not_hack_it159 	{
#define Do_not_hack_it29 	int u,v;
#define Do_not_hack_it81 bool check(int u,int v,int uu,int vv)
#define Do_not_hack_it75 {
#define Do_not_hack_it34 	dep[0]=-1;
#define Do_not_hack_it59 			else st[i][j]=st[i-1][j+p2[i-1]];
#define Do_not_hack_it148 	}
#define Do_not_hack_it157 	for(int i=1;i<=M;i++) 
#define Do_not_hack_it114 vector<int> g[N+5];
#define Do_not_hack_it136 			else now=t[x];
#define Do_not_hack_it145 	len=l2[len];
#define Do_not_hack_it36 	if(check(l.lx,l.rx,r.lx,r.rx)) res.lx=l.lx,res.rx=l.rx,res.flag=1;
#define Do_not_hack_it146 	p2[0]=1,l2[1]=0;
#define Do_not_hack_it96 	res.r=r.r;
#define Do_not_hack_it40 void build(int x,int l,int r)
#define Do_not_hack_it139 		if(v==fa) continue;
#define Do_not_hack_it79 			scanf("%d%d",&u,&v);
#define Do_not_hack_it75 {
#define Do_not_hack_it74 	else return st[len][r-p2[len]+1];
#define Do_not_hack_it28 	return false;
#define Do_not_hack_it149 int sizest,ll[N+5];
#define Do_not_hack_it143 	if(p<=mid) change(x*2,p,v);
#define Do_not_hack_it45 		{
#define Do_not_hack_it115 	return;
#define Do_not_hack_it168 		if(!now.flag) now=t[x*2];
#define Do_not_hack_it23 	dfs(1,0);
#define Do_not_hack_it88 	if(!l.flag) return res;
#define Do_not_hack_it148 	}
#define Do_not_hack_it16 		add(i,v);
#define Do_not_hack_it150 const int N=1000000;
#define Do_not_hack_it147 	if((lca(u,x)==x||lca(v,x)==x)&&lca(fa,x)==fa) return true;
#define Do_not_hack_it38 		}
#define Do_not_hack_it162 bool checkx(int u,int v,int x)
#define Do_not_hack_it45 		{
#define Do_not_hack_it31 }
#define Do_not_hack_it166 			now.lx=now.rx=-1;
#define Do_not_hack_it132 		sizest++;
#define Do_not_hack_it31 }
#define Do_not_hack_it141 	else if(check(l.lx,r.lx,l.rx,r.rx)) res.lx=l.lx,res.rx=r.lx,res.flag=1;
#define Do_not_hack_it85 	} 
#define Do_not_hack_it39 tree up(tree l,tree r)
#define Do_not_hack_it125 	for(int i=2;i<=n;i++)
#define Do_not_hack_it94 		t[x].flag=1;
#define Do_not_hack_it123 int main()
#define Do_not_hack_it75 {
#define Do_not_hack_it172 	st[0][sizest]=u;
#define Do_not_hack_it118 	if(t[x].l==t[x].r)
#define Do_not_hack_it159 	{
#define Do_not_hack_it120 	build(x*2+1,mid+1,r);
#define Do_not_hack_it159 	{
#define Do_not_hack_it154 		dfs(v,u);
#define Do_not_hack_it60 	g[u].push_back(v);
#define Do_not_hack_it173 	if(dep[st[len][l]]<dep[st[len][r-p2[len]+1]]) return st[len][l];
#define Do_not_hack_it159 	{
#define Do_not_hack_it38 		}
#define Do_not_hack_it159 	{
#define Do_not_hack_it31 }
#define Do_not_hack_it67 using namespace std;
#define Do_not_hack_it18 int lca(int u,int v)
#define Do_not_hack_it115 	return;
#define Do_not_hack_it46 			change(1,p[u],u);
#define Do_not_hack_it31 }
#define Do_not_hack_it2 			if(dep[st[i-1][j]]<dep[st[i-1][j+p2[i-1]]]) st[i][j]=st[i-1][j];
#define Do_not_hack_it31 }
#define Do_not_hack_it181 	dep[u]=dep[fa]+1;
#define Do_not_hack_it5 	build(x*2,l,mid);
#define Do_not_hack_it97 	if(l>r) return 0;
#define Do_not_hack_it171 	for(int i=0;i<g[u].size();i++)
#include<bits/stdc++.h>
Do_not_hack_it67
Do_not_hack_it150
Do_not_hack_it54
Do_not_hack_it89
Do_not_hack_it75
Do_not_hack_it22
Do_not_hack_it129
Do_not_hack_it93
Do_not_hack_it57
Do_not_hack_it131
Do_not_hack_it149
Do_not_hack_it114
Do_not_hack_it155
Do_not_hack_it75
Do_not_hack_it60
Do_not_hack_it41
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it170
Do_not_hack_it75
Do_not_hack_it104
Do_not_hack_it7
Do_not_hack_it172
Do_not_hack_it181
Do_not_hack_it171
Do_not_hack_it159
Do_not_hack_it86
Do_not_hack_it139
Do_not_hack_it154
Do_not_hack_it132
Do_not_hack_it68
Do_not_hack_it148
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it65
Do_not_hack_it75
Do_not_hack_it97
Do_not_hack_it70
Do_not_hack_it145
Do_not_hack_it173
Do_not_hack_it74
Do_not_hack_it31
Do_not_hack_it167
Do_not_hack_it75
Do_not_hack_it157
Do_not_hack_it159
Do_not_hack_it128
Do_not_hack_it45
Do_not_hack_it2
Do_not_hack_it59
Do_not_hack_it38
Do_not_hack_it148
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it165
Do_not_hack_it75
Do_not_hack_it146
Do_not_hack_it142
Do_not_hack_it53
Do_not_hack_it34
Do_not_hack_it23
Do_not_hack_it37
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it18
Do_not_hack_it75
Do_not_hack_it62
Do_not_hack_it14
Do_not_hack_it15
Do_not_hack_it31
Do_not_hack_it162
Do_not_hack_it75
Do_not_hack_it102
Do_not_hack_it147
Do_not_hack_it28
Do_not_hack_it31
Do_not_hack_it81
Do_not_hack_it75
Do_not_hack_it51
Do_not_hack_it42
Do_not_hack_it28
Do_not_hack_it31
Do_not_hack_it39
Do_not_hack_it75
Do_not_hack_it3
Do_not_hack_it111
Do_not_hack_it96
Do_not_hack_it0
Do_not_hack_it133
Do_not_hack_it47
Do_not_hack_it88
Do_not_hack_it19
Do_not_hack_it36
Do_not_hack_it141
Do_not_hack_it100
Do_not_hack_it103
Do_not_hack_it108
Do_not_hack_it178
Do_not_hack_it116
Do_not_hack_it31
Do_not_hack_it40
Do_not_hack_it75
Do_not_hack_it4
Do_not_hack_it159
Do_not_hack_it12
Do_not_hack_it32
Do_not_hack_it94
Do_not_hack_it117
Do_not_hack_it148
Do_not_hack_it122
Do_not_hack_it5
Do_not_hack_it120
Do_not_hack_it112
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it83
Do_not_hack_it75
Do_not_hack_it118
Do_not_hack_it159
Do_not_hack_it77
Do_not_hack_it94
Do_not_hack_it117
Do_not_hack_it148
Do_not_hack_it69
Do_not_hack_it143
Do_not_hack_it152
Do_not_hack_it112
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it174
Do_not_hack_it75
Do_not_hack_it58
Do_not_hack_it159
Do_not_hack_it84
Do_not_hack_it45
Do_not_hack_it26
Do_not_hack_it136
Do_not_hack_it38
Do_not_hack_it117
Do_not_hack_it148
Do_not_hack_it27
Do_not_hack_it159
Do_not_hack_it168
Do_not_hack_it98
Do_not_hack_it50
Do_not_hack_it85
Do_not_hack_it110
Do_not_hack_it115
Do_not_hack_it31
Do_not_hack_it123
Do_not_hack_it75
Do_not_hack_it144
Do_not_hack_it17
Do_not_hack_it29
Do_not_hack_it125
Do_not_hack_it159
Do_not_hack_it6
Do_not_hack_it16
Do_not_hack_it148
Do_not_hack_it90
Do_not_hack_it92
Do_not_hack_it156
Do_not_hack_it151
Do_not_hack_it159
Do_not_hack_it9
Do_not_hack_it66
Do_not_hack_it45
Do_not_hack_it79
Do_not_hack_it30
Do_not_hack_it46
Do_not_hack_it87
Do_not_hack_it38
Do_not_hack_it105
Do_not_hack_it45
Do_not_hack_it166
Do_not_hack_it163
Do_not_hack_it135
Do_not_hack_it73
Do_not_hack_it38
Do_not_hack_it148
Do_not_hack_it95
Do_not_hack_it31