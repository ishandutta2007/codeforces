#\
i\
n\
c\
l\
u\
de<\
c\
s\
t\
d\
io\
>\

\
#\
inclu\
de\
<\
al\
g\
o\
r\
it\
hm>\

\
#\
i\
nc\
lu\
de<\
cs\
t\
r\
i\
n\
g\
>
#\
i\
nc\
l\
u\
d\
e\
<st\
r\
i\
n\
g\
>\

#\
in\
c\
lude\
<c\
ma\
th\
>\

\
#\
d\
efi\
n\
e\
 \
e\
xp \
ex\
p\
p
usi\
n\
g \
n\
a\
m\
esp\
ace \
st\
d;\

\
lo\
n\
g\
 \
d\
ou\
b\
l\
e \
e\
xp\
[\
200\
]\
[\
1\
0\
],\
 \
a\
n\
s[\
20\
0]\
[\
2\
0]\
,\
 a\
s,\
 \
a\
[\
2\
0\
0][200\
]\
, \
s\
mx\
[2\
0\
0\
]\
[\
20\
0\
], \
f\
[\
1\
0\
]\
[2\
0\
0\
]\
[\
20\
0\
];\

\
d\
ou\
ble\
 x\
;\

\
//con\
s\
t\
 \
d\
o\
u\
ble\
 \
e\
p\
s\
 \
=\
 \
1e\
-\
18\
;
\
int\
 \
n\
,\
 \
b\
[100\
];\

i\
n\
t\
 m\
a\
i\
n\
(\
)\
 {\

\
	scan\
f\
(\
"\
%\
d\
"\
, &\
n\
)\
;
\
	\
i\
nt\
 m\
 \
=\
 \
1\
 \
<\
< \
n;\

	\
f\
o\
r\
(\
i\
nt\
 \
i\
 =\
 \
1\
;\
 \
i\
 <=\
 \
m\
;\
 \
i\
+\
+)\
 {\

\
	\
	\
fo\
r\
(i\
n\
t\
 j\
 \
=\
 1\
;\
 \
j\
 \
<= m\
; \
j\
++\
) \
{\

\
	\
	\
	\
sc\
a\
n\
f\
(\
"\
%lf\
",\
 \
&\
x\
)\
;
\
	\
	\
	\
a\
[\
i\
][\
j\
]\
 \
=\
 \
1.\
0\
 \
*\
 \
x \
/ 1\
00\
.\
0\
;\
 \

\
	\
	\
}\

	\
	\
e\
x\
p\
[\
i\
]\
[\
0\
]\
 \
=\
 \
1;\

\
	\
}\

\
	\

\
	\
f\
or\
(\
i\
nt\
 \
i\
 =\
 1\
;\
 \
i\
 <\
=\
 n; \
i\
++\
) \
{/\
/\
?\
?\
?\
?\
?\
? \

\
	\
	\
i\
n\
t\
 \
l\
e\
n\
 \
= 1\
 <\
< \
i\
;\

\
	\
	\
f\
or\
(\
i\
n\
t\
 \
j =\
 \
1\
;\
 \
j \
<\
=\
 \
m\
; j +\
= \
le\
n\
) \
{\
/\
/?\
???\
\

	\
	\
	\
f\
or(\
i\
nt \
k\
 \
=\
 j\
;\
 k\
 \
< \
j\
 \
+\
 \
le\
n\
;\
 \
k+\
+\
) \
{
\
	\
			\
l\
o\
ng\
 \
d\
ou\
b\
le\
 \
t\
m\
p \
= \
0\
;
\
		\
		\
if\
(\
k\
 \
- \
j \
< \
l\
e\
n\
 \
/\
 \
2)\
 \
{\

\
	\
		\
	\
	\
for\
(\
int \
l \
=\
 \
j\
 +\
 \
le\
n \
/ 2\
; \
l\
 \
< \
j\
 +\
 l\
e\
n\
;\
 \
l++\
) t\
m\
p\
 \
= t\
m\
p +\
 \
e\
xp\
[\
l\
][i\
 -\
 1\
]\
 *\
 a\
[\
k][\
l\
]; \
 \

\
	\
	\
	\
	\
}\
 e\
l\
s\
e\
 \
{\

		\
	\
	\
	f\
or(\
i\
n\
t\
 l =\
 \
j\
;\
 \
l \
< j +\
 \
len\
 \
/\
 \
2\
;\
 l\
+\
+\
) \
tm\
p \
=\
 t\
m\
p \
+ \
ex\
p\
[l\
]\
[\
i -\
 \
1\
]\
 *\
 \
a\
[\
k\
][\
l\
];\

\
		\
	\
	\
}\

	\
		\
	\
/\
/i\
f\
(k\
 \
== \
1\
)\
 \
p\
rin\
tf(\
"%\
l\
f\\
n\
", \
ex\
p\
[k]\
[\
i\
])\
;
\
	\
	\
	\
	\
e\
xp\
[\
k\
]\
[i\
]\
 =\
 \
ex\
p[\
k]\
[i\
 \
- \
1\
] *\
 \
tmp\
;\

\
		\
	\
} \

\
	\
	\
}
	\
}\

\
	\
for\
(i\
nt \
i = 1; \
i\
 \
<\
=\
 \
m\
; \
i\
+\
+\
)\
 \

\
	\
	f\
o\
r(\
in\
t \
j\
 \
= \
1\
;\
 j\
 \
<\
= \
n\
;\
 j\
+\
+\
)\
 {
	\
		\
ans[\
i]\
[j\
] =\
 a\
n\
s[\
i\
]\
[j\
 -\
 \
1]\
 \
+ \
ex\
p\
[i]\
[j\
]\
 \
* \
(\
1\
 <\
<\
 (\
j\
 \
-\
 \
1\
)\
)\
;
\
	\
	}\

\
	\
/\
*\
f\
or(\
i\
nt \
i\
 \
=\
 \
1\
;\
 \
i \
<\
=\
 m\
;\
 i+\
+)\
 {
\
		\
fo\
r(\
in\
t\
 \
j\
 \
= \
1\
; \
j\
 \
<\
=\
 \
n;\
 \
j\
++\
)\
 p\
r\
in\
tf\
("%\
l\
f\
 "\
,\
 a\
n\
s[i\
]\
[j]);
\
	\
	\
pu\
t\
s("\
");\

\
	\
}*\
/\

\
	\
f\
o\
r(\
in\
t\
 \
i\
 \
= 1\
, cn\
t \
=\
 1;\
 i\
 \
<\
=\
 \
m\
; \
i += 2,\
 c\
n\
t\
++)\
 \
{
	\
	\
f\
[1\
][\
c\
n\
t\
]\
[\
i] \
=\
 \
e\
xp[i][\
1\
];\

\
		s\
mx[1\
][c\
n\
t\
]\
 \
=\
 \
m\
ax\
(e\
x\
p\
[\
i\
][\
1\
]\
, e\
x\
p[i\
 \
+\
 \
1\
][\
1]\
); 
	\
	\
f[1\
][\
c\
n\
t\
]\
[\
i\
 \
+\
 \
1\
]\
 =\
 e\
x\
p\
[i \
+\
 1\
]\
[\
1];\

\
	\
}\

\
	\
fo\
r\
(\
i\
nt i\
 = \
1\
;\
 \
i \
< \
n; i\
+\
+\
)\
 \
{\

\
	\
	\
int\
 l\
en \
=\
 \
1 <\
<\
 (\
i +\
 \
1\
)\
;\

\
	\
	\
f\
or(\
i\
n\
t \
j\
 \
=\
 \
1\
,\
 \
c\
n\
t\
 =\
 \
1\
;\
 j\
 \
<\
=\
 m\
;\
 \
j\
 +=\
 le\
n, \
c\
n\
t++\
)\
 \
{
\
		\
	\
f\
o\
r\
(i\
n\
t\
 k =\
 j\
;\
 \
k\
 < \
j\
 \
+ \
l\
e\
n; \
k\
+\
+\
) {\

	\
		\
	if(\
k\
 \
- \
j\
 < \
le\
n\
 /\
 \
2\
) {
	\
	\
			\
f\
[\
i\
 \
+ 1]\
[\
c\
n\
t\
]\
[k\
] \
=\
 f[\
i\
][\
cn\
t\
 \
*\
 2 \
- \
1\
]\
[k\
] \
+ e\
x\
p\
[\
k\
][\
i +\
 \
1]\
 *\
 (\
1 <\
<\
 \
i\
) \
+\
 s\
mx[\
i\
]\
[\
c\
n\
t\
 * \
2\
]\
;\

	\
			\
} el\
s\
e\
 {\

	\
	\
	\
	\
	f\
[\
i\
 \
+\
 \
1\
][c\
nt\
]\
[\
k\
]\
 \
=\
 f\
[i\
]\
[c\
nt \
*\
 \
2\
][k\
]\
 \
+\
 \
e\
x\
p\
[\
k\
]\
[i +\
 1\
]\
 \
*\
 (\
1\
 \
<\
<\
 i)\
 +\
 \
sm\
x\
[\
i\
]\
[\
c\
n\
t\
 \
*\
 2\
 \
-\
 \
1\
];
		\
		\
}
	\
	\
	\
	\
s\
m\
x\
[\
i\
 \
+\
 \
1]\
[c\
nt]\
 \
=\
 \
m\
a\
x\
(\
smx[\
i\
 \
+\
 1\
]\
[\
c\
nt\
]\
, \
f\
[i\
 \
+\
 \
1\
]\
[\
c\
n\
t]\
[k\
]\
)\
;\

\
			\
}\

\
		}\

\
	\
}\

\
	\
p\
ri\
n\
tf\
("%.2\
0\
l\
f\
\n",\
 \
(\
d\
oub\
l\
e)\
smx[n\
]\
[1\
]\
);\

	\
r\
e\
t\
ur\
n\
 0\
;
} \