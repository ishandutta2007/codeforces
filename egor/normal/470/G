0k:
[^$10=~][1k;+k:]#%
k;n:
[^$10=~][1n;+n:]#%
n;x:
0a:
[k;0=~][k;1-k:k;On;O=~_a;+a:n;1-n:]#
a;.
[x;0=~][x;1-x:%]#