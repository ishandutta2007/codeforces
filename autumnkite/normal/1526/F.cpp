// ...,o[[[[[[[[ooo[[[[\oooOooooo**]]]`,oOO@@@@@OOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OoOOOOOOOOOOOOOOO
// ....*.........*.........*........**.*oOOOOOOOOOOOOOOOo\oOOOOOOOooooOOOOOOOOOOOOOOOO@@@@o**/oOOOOOOOOOOOO
// /**[oooo\]*[ooooo]]`**,/o***....,OOO@OOO@@@OOOOOOOO@@@O\`=O\*OOOOO@@O\*[[\\ooooOOOOOO@OO**oOOOOOOOOOOOOO
// ........**........[`......*,OOO@@@@@OO@O@@OOOOOOOOOOO@@@OO\@@OOOo[oOOOOOo`*......***o@Oo**oo^*****^**...
// ........*`........**....,]/O@@@@OOOOO@@@@@OO@O@@@@@OOOO@@@OOO\OO@OOOO@OOOOOo^*..***=O@Oo**ooo****oo^****
// ****oooo/[`*=oo\`,^**]O@@@@@@@OoOOooO@@O[O@@@@@@@@@@@@@OOO@@@OOOOOO@OO@@OOOOoo`*.**=O@O/**ooo***********
// ..............*..../@@@@O[O@O^]O@OO@@@@OOO@@@@@@@@@@@@@@@@@@@@@OOOOOO@OOOOOOOOOoo]*,O@O^**oo/***********
// `**=o\*****..**.,O@@@O*,O@@OOO@@@OO@@OOO@@@O@@@@@O@@@@@@@@@@@@@@@OOOOO@OOOOOOOOO\/\*,OO^**oo^........*..
// ........**....,O@@OO\/O@@@@OO@@@@@@@@OO@@@@@@@@@@@@@@@@@@@@@@@@@@@OO@OOOOOOOOOOOOOOo`*,`**oo^...........
// .............OOOOOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOOOOOoOOOOo`***oo*...........
// ****,]**=o\oO@OOOO@@@@@@@@@@@O@@@@@@@@@@@@@@@@@@@@@@@@@@@OO@@@@@@@@@@@@@@@@OO@OOOOOOOOO]**oo*...........
// ....**..*/O@OOOO@@@@@@@@@@@@OO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOOo/\OOOOOOOo*...........
// ****/`*,O@@@OO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Oo]]oOOOO@OO^....   ....
// *....,oOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O@@@@OOOO`*oOO@OO^...   ....
// ......=O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O@@O^*O@OOO\..    ....
// `**,oO@@@@OOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOOOOOOOOOOOO@@@@@@@@@@@@@@Oooo\O@@O.     ...
// ....oO@@@@OO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OO/o[***oo[*****,oOOOOOOOO@@@@@@@@@OO\oO@@O`    ...
// ...,OO@@OOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OO`*................,[[`**,\oOO@@@@@@@@O^=O@@O.   ...
// **=OO@OOO@@@@@@@@@@@@@@@@@@@@@@OOOO@OOOOOOOO@@@@@OO/*...........................*,\O@@@@@@@@OO@@^.   ...
// ../O@@@@@@@@@@@@@@@@@@OO@@@OOO@OOOOOOoooooooOOOOOoo*.....         .......      ....\O@@@@@@@@@O@O^.  ...
// *=O@@@@@@@@@@@@@@@@@OOOOOOOOo/oo/*[****....**,\/*.....                           ...\O@@@@@@@@@@@o.  ...
// .=@@@@@@@@@@@@@@@@Ooooo[****.......................                               ...OO@@@@@@@@@@O.  .. 
// *O@@@@@@@@@@@@@@@Ooo`**.............                                               ..,O@@@@@@@@@@@O.    
// *\O@@@@@@@@@@@@@OO**..........                                  .......]]]]*,*..    ..=O@@@@@@@@@@/.    
// .=O@@@@@@@@@@@@@Oo*...............      .....  ....      .......,]/O@@@OO@OOo/[^*.   ..=O@@@@@@@@@O.    
// `oO@@@@@@@@@@@@@Oo*........,/ooooOOOOOO\]]`*`.............*,/OO@@@@@@O/[[.*......*..   .,O@@@@@@@@O.  . 
// .\O@@@@@@@@@@@@@O/.......*/oOOOO@@@@@@@@@@@OO\*...........*oOOOOOo`..       .........   .,O@@@@@@@O.    
// .=O@@@@@@@@@@@@@O^....../Oo=oo[[`**,**[[[\oOO/**...........**[`*..............*=o]]`..    =@@@@@@Oo..   
// **\@@@@@@@@@@@@@O*.....*`***.......    ......**.....     ....,oOOo*.          ....\@@@@@` .@@@@@@O/.    
// ..,O@@@@@@@@@@@O^......*.......        ....**]]...        ,OO[`....,]]]]]]]..   .  .@@/\OO`,O@@@@O`     
// `.,O@@@@@@@@@@@O`.............,]`***..........*[\OOOO@@@@@@   ...oO@@@@@@@@@@@OO*..,OO..[\OO\=@@@O.     
// ...,O@@@@@@@@@@o*..... ..]/OO[`.   ,]]/OOO\`...   ,@@`  ,\O      ............   ....[`.     ,@@@O`.  .  
// ....O@@@@@@@@@O^....,]O@@@/....]O@@@@@@@OO[[.     =O^    =@O        ........        ..       =O^       .
// ***.,O@@@@@@@@@^]OOO@@@@@^../OO@O/[[[......      ,@@O.    \@\                       *        .OO`,/\]   
// .....,O@@@@@@@OOOOO[.  .OO. .       .....       .O@@`      ,@\                    ..         .\OOOOO@O. 
// *...../@@@@@O@@@O`..... .O^                     .=@`         \O`              ..=*.           .o..,OOO^ 
// ....=`[\@@@@@@@^.......  =\.                  ...O`            [[**...........                .[. .[oo. 
// ....     .\O@@O......     ,^                ..]/O`  .........     ..              ..         ..,*. .\.. 
// *,.  ,/O\].O@@@^......  .  .o]...........]]\`[[`  .,]/oOOOOOOO\`. .....            ...  .......OO...*.  
// ..../@@OOOOO@@O^...........  ........  .   ..*...]@@@@OOOOO@@@@@O\.....             ...........OO^. ..  
// *...O@@O^.=O@OO\...............         .....,oO/O@OOOOOOOO[*,\OO/.               ..............\`.     
// .*...O@O^.*\OOOO*.............         ........\OOO`.......                  ................  ...      
// .....,OO^.=OO@@O^...........................      ..... ...                   ...............           
// *.**].,[^.oOO@@@^........................                                     ...............     .     
// ..........oOOOOO`.......................             .]]].,]/o]].   ......     .............            
// ..........,OO^..=^***..............................,OOOOOOOOOO@@@@\]..*****..  .............            
// ****,****........**...........................***/@@@@@@@@@@@OOO@@@@@@@OO\*..................]]...      
// ..............   .**......................=oooOO@@@@@/[.....     .,\OOOOOOo`...  ................       
// *..***.......*. ....*....................=ooO@@@@@O`.**]]*..,/\]]*.....*,ooo*............**.            
// ........**...      ..*...................*oOOOOo`**=oOOOO@@@@@@@OO\]*...**oo`*..........**..,]**........
// .............      .=\*.*................*=oo/******\OOO@@@OOOOOOOo`*******[[*****.....***.*=^***,[[oooo
// .*************....*]Oo`****..............*,\^**...*****........  ........*.********.**/o^..=^***********
// ..............*........******........*******[***.......   ....      ........*******,ooOo`.,oo/oo\]]]]]]]
// ...***.......**........*/`]/\*******************.............................*/ooooooOO^. .........*****
// ..................*......*\ooooo\]**************.......*]o\]]]]]/]]`.......**ooOOOOOOOo*.               
// ..................*.......*oooooooooooooooo^******..*,oOOOOOOOOOOOOOOoooooooOOOOOOOOOo*..               
// ...**..***..***..*`]****`***ooOOOOOOOOOOOOOoooooooooOOOOOOO@@@@@@@@OOOOOOOOO@@@OOOOOo*... ,/\`....      
// ....*.......................*oOOOOOOOOOOOOOOOOOOOOOOOOO@@@@@@@@@@@@@@@@@@@@@@OOOOOOo`.... .O@Ooo*...    
// ...***.......***.......*.....,ooOOOOOOOOOOOOOOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOOOo`*.... .OOOo*...     

#include <bits/stdc++.h>

int query(int x, int y, int z) {
	std::cout << "? " << x + 1 << " " << y + 1 << " " << z + 1 << std::endl;
	int res;
	std::cin >> res;
	return res;
}

void solve() {
	std::mt19937 rnd(std::chrono::system_clock::now().time_since_epoch().count());
	int n;
	std::cin >> n;
	int x, y, z;
	do {
		x = rnd() % n, y = rnd() % n, z = rnd() % n;
	} while (x == y || x == z || y == z || query(x, y, z) >= n / 6);
	std::vector<std::pair<int, int>> dis;
	for (int i = 0; i < n; ++i) {
		if (i != x && i != y) {
			dis.emplace_back(query(x, y, i), i);
		}
	}
	std::sort(dis.begin(), dis.end());
	int p, q;
	if (dis[n - 3].first != dis[n - 4].first) {
		if (dis[n - 4].first != dis[n - 5].first) {
			p = dis[n - 3].second, q = dis[n - 4].second;
		} else {
			p = dis[n - 3].second, q = dis[n - 5].second;
			if (query(p, q, x) >= n / 2 && query(p, q, y) >= n / 2) {
				q = dis[n - 4].second;
			}
		}
	} else {
		p = dis[n - 3].second, q = dis[n - 5].second;
		if (query(p, q, x) >= n / 2 - 1 && query(p, q, y) >= n / 2 - 1) {
			p = dis[n - 4].second;
		}
	}
	std::vector<int> ans(n);
	ans[p] = 0, ans[q] = 1;
	for (int i = 0; i < n; ++i) {
		if (i != p && i != q) {
			ans[i] = query(p, q, i) + 1;
		}
	}
	if (ans[0] > ans[1]) {
		for (int i = 0; i < n; ++i) {
			ans[i] = n - ans[i] - 1;
		}
	}
	std::cout << "!";
	for (int x : ans) {
		std::cout << " " << x + 1;
	}
	std::cout << std::endl;
	int res;
	std::cin >> res;
	assert(res == 1);
}

int main() {
	std::ios_base::sync_with_stdio(false);
	std::cin.tie(0);

	int T;
	std::cin >> T;
	while (T--) {
		solve();
	}
}