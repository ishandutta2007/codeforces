#include <bits/stdc++.h>
using namespace std;
#define pb push_back
#define M 1000000007
#define MM 998244353
#define fr first
#define sc second
#define vc vector
#define pii pair<int,int>
#define msi map<string,int>
#define mii map<int,int>
#define psi pair<string,int>
#define pis pair<int,string>
#define piii pair<int,pii>
int gcd(int a,int b){
    if(b==0)return a;
    return gcd(b,a%b);
}

/*
v[i] is a vector that stores info about notifications generated by i-th app
(int,int)
the first is 0(unread) or 1(read)
second contains the position of this notification in vector z
*/
vc<pii> v[300009];
/*
vector z contains info about all notifications
(int,(int,int))
first is 0 or 1, unread or read
second.first is the app-number which created the notification
second.second is the position of the notification in the app vector
*/
vc<piii> z;
/*
all notifications of the i-th app have been read upto the value r[i]
------
all notifications in the vector z have been read uptil rz
*/
int r[300009],rz=0,unread=0;
void solve(){
    int n,q;
    cin>>n>>q;
    for(int i=0;i<q;i++){
        int a,b;
        cin>>a>>b;
        if(a==1){
            v[b].pb({0,z.size()});
            z.pb({0,{b,v[b].size()-1}});
            unread++;
        }
        else if(a==2){
            for(int i=r[b];i<v[b].size();i++){
                if(v[b][i].fr)continue;
                v[b][i].fr=1;
                unread--;
                z[v[b][i].sc].fr=1;
            }
            r[b]=v[b].size();
        }
        else{
            for(int i=rz;i<b;i++){
                if(z[i].fr)continue;
                z[i].fr=1;
                unread--;
                v[z[i].sc.fr][z[i].sc.sc].fr=1;
            }
            rz=max(rz,b);
        }
        cout<<unread<<"\n";
    }
}
signed main(){
    ios_base::sync_with_stdio(false);
    //freopen("input.txt", "r", stdin);
    //freopen("output.txt", "w", stdout);
    int t=1;
    //cin>>t;
    while(t--) solve();
    return 0;
}