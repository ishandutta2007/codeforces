[0[^$$47>\57>~&][48-\10*+]#]r:

[
  [$1-\0>][r;!%\]#%
]w:

[
  [$1-\0>][\%]#%
]p:

r;!%n:

n;w;!
n;10+l:

1_q: [q;1+$q:l;\>] [
  0i: [i;$2+i:1+n;\>] [
    n;1-O
    n;1-O
    1O1O>[\]?
  ]#
  n;$2/2*=~[
    n;1-O
  ]?

  n;1-O
  1i: [i;$2+i:1+n;\>] [
    n;1-O
    n;1-O
    1O1O>[\]?
  ]#
  n;$2/2*=[
    n;1-O
  ]?
]#

0i: [i;$1+i:n;\>] [
  n;i;-O." "
]#

n;l;2*1+*p;!