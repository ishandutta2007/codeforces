#define S scanf("%d",
#define f(i)for(i=0;i++<
#define M[201]
int*x,a M,h M,g M M,u M M,n,p,q,s,i,j;main(D){S&n),S&x);f(i)2*n;s+=a[i]=i<=n?g[i][D=i+n]=p:-p)S&p);f(i)x;g[p][q+n]=g[q][p+n]=1)S&p),S&q);for(;--j;)f(i)D;s|(h[i]+=p)>D?exit(puts("NO")):0)if(p=a[i]>0)f(j)D;)g[i][j]|g[j][i]&&h[i]>h[j]?q=a[i],x=u[j]+i,i<j?u[i][j]+=q:*x<q?q=*x:0,*x-=q,p&=!q,a[i]-=q,a[j]+=q:0;puts("YES");f(i)n;)f(j)n;)printf("%d\n",u[i][j+n]);}