I=input
for _ in[0]*int(I()):
 I();d=dict(zip(I().split(),I().split()));c=0
 while d:
  c+=1;x,y=d.popitem()
  while y:=d.pop(y,0):y
 print(pow(2,c,10**9+7))